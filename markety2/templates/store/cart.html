{% extends 'base.html' %}
{% block content %}
<h3>Your Cart</h3>
<div class="table-responsive">
  <table class="table">
    <thead>
      <tr><th>Product</th><th>Price</th><th>Quantity</th><th>Subtotal</th><th></th></tr>
    </thead>
    <tbody>
    {% for item in items %}
      <tr>
        <td><a href="{% url 'product_detail' item.product.slug %}">{{ item.product.name }}</a></td>
        <td>{{ item.product.price }} $</td>
        <td style="max-width:140px;">
          <form method="post" action="{% url 'update_cart' item.product.id %}">
            {% csrf_token %}
            <div class="input-group">
              <input type="number" name="quantity" value="{{ item.quantity }}" min="0" class="form-control">
              <button class="btn btn-outline-secondary" type="submit">Update</button>
            </div>
          </form>
        </td>
        <td>{{ item.subtotal }} $</td>
        <td><a href="{% url 'remove_from_cart' item.product.id %}" class="btn btn-sm btn-danger">Remove</a></td>
      </tr>
    {% empty %}
      <tr><td colspan="5">Your cart is empty.</td></tr>
    {% endfor %}
    </tbody>
    {% if items %}
    <tfoot>
      <tr><th colspan="3" class="text-end">Total</th><th>{{ total }} $</th><th></th></tr>
    </tfoot>
    {% endif %}
  </table>
</div>
{% if items %}
  <a href="{% url 'checkout' %}" class="btn btn-success">Proceed to Checkout</a>
{% endif %}
{% endblock %}
